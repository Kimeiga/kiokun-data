# Dictionary Sharding Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GitHub Actions (Matrix)                      â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Job 1       â”‚  â”‚  Job 2       â”‚  â”‚  Job 3       â”‚  â”‚  Job 4   â”‚â”‚
â”‚  â”‚  non-han     â”‚  â”‚  han-1char   â”‚  â”‚  han-2char   â”‚  â”‚ han-3plusâ”‚â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚          â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚ â”‚Download  â”‚ â”‚  â”‚ â”‚Download  â”‚ â”‚  â”‚ â”‚Download  â”‚ â”‚  â”‚â”‚Downloadâ”‚â”‚â”‚
â”‚  â”‚ â”‚Sources   â”‚ â”‚  â”‚ â”‚Sources   â”‚ â”‚  â”‚ â”‚Sources   â”‚ â”‚  â”‚â”‚Sources â”‚â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚    â”‚     â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚ â”‚Build     â”‚ â”‚  â”‚ â”‚Build     â”‚ â”‚  â”‚ â”‚Build     â”‚ â”‚  â”‚â”‚Build   â”‚â”‚â”‚
â”‚  â”‚ â”‚Rust      â”‚ â”‚  â”‚ â”‚Rust      â”‚ â”‚  â”‚ â”‚Rust      â”‚ â”‚  â”‚â”‚Rust    â”‚â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚    â”‚     â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚ â”‚Generate  â”‚ â”‚  â”‚ â”‚Generate  â”‚ â”‚  â”‚ â”‚Generate  â”‚ â”‚  â”‚â”‚Generateâ”‚â”‚â”‚
â”‚  â”‚ â”‚Files     â”‚ â”‚  â”‚ â”‚Files     â”‚ â”‚  â”‚ â”‚Files     â”‚ â”‚  â”‚â”‚Files   â”‚â”‚â”‚
â”‚  â”‚ â”‚--mode    â”‚ â”‚  â”‚ â”‚--mode    â”‚ â”‚  â”‚ â”‚--mode    â”‚ â”‚  â”‚â”‚--mode  â”‚â”‚â”‚
â”‚  â”‚ â”‚non-han   â”‚ â”‚  â”‚ â”‚han-1char â”‚ â”‚  â”‚ â”‚han-2char â”‚ â”‚  â”‚â”‚han-3+  â”‚â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚    â”‚     â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚ â”‚Push to   â”‚ â”‚  â”‚ â”‚Push to   â”‚ â”‚  â”‚ â”‚Push to   â”‚ â”‚  â”‚â”‚Push to â”‚â”‚â”‚
â”‚  â”‚ â”‚GitHub    â”‚ â”‚  â”‚ â”‚GitHub    â”‚ â”‚  â”‚ â”‚GitHub    â”‚ â”‚  â”‚â”‚GitHub  â”‚â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                       â”‚
â”‚                    â±ï¸  Total Time: ~30 minutes                        â”‚
â”‚                    ðŸ’° Cost: FREE (2000 min/month)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GitHub Repositories                          â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ japanese-dict- â”‚  â”‚ japanese-dict- â”‚  â”‚ japanese-dict- â”‚  ...   â”‚
â”‚  â”‚ non-han        â”‚  â”‚ han-1char      â”‚  â”‚ han-2char      â”‚        â”‚
â”‚  â”‚                â”‚  â”‚                â”‚  â”‚                â”‚        â”‚
â”‚  â”‚ ~50k files     â”‚  â”‚ ~15k files     â”‚  â”‚ ~200k files    â”‚        â”‚
â”‚  â”‚ ~200 MB        â”‚  â”‚ ~600 MB        â”‚  â”‚ ~800 MB        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                       â”‚
â”‚                    ðŸ“¦ Total: ~430k files, ~2.3 GB                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         jsDelivr CDN                                 â”‚
â”‚                                                                       â”‚
â”‚  ðŸŒ 750+ CDN locations worldwide                                     â”‚
â”‚  âš¡ Automatic caching & optimization                                 â”‚
â”‚  ðŸ†“ Unlimited bandwidth                                              â”‚
â”‚  ðŸ“Š 99.9% uptime SLA                                                 â”‚
â”‚                                                                       â”‚
â”‚  URL Format:                                                         â”‚
â”‚  https://cdn.jsdelivr.net/gh/Kimeiga/japanese-dict-{shard}@main/    â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SvelteKit App                                â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ User visits: /å¥½                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ shard-utils.ts                                               â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚ 1. Count Han characters: å¥½ â†’ 1 Han char                    â”‚   â”‚
â”‚  â”‚ 2. Determine shard: han-1char                                â”‚   â”‚
â”‚  â”‚ 3. Construct URL:                                            â”‚   â”‚
â”‚  â”‚    cdn.jsdelivr.net/gh/.../japanese-dict-han-1char@main/å¥½.jsonâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ +page.ts                                                      â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚ 1. Fetch from jsDelivr                                       â”‚   â”‚
â”‚  â”‚ 2. Expand optimized fields                                   â”‚   â”‚
â”‚  â”‚ 3. Handle redirects                                          â”‚   â”‚
â”‚  â”‚ 4. Fetch related words                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ +page.svelte                                                  â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚ Render dictionary entry with:                                â”‚   â”‚
â”‚  â”‚ - Chinese definitions                                        â”‚   â”‚
â”‚  â”‚ - Japanese readings                                          â”‚   â”‚
â”‚  â”‚ - Character details                                          â”‚   â”‚
â”‚  â”‚ - Related words                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

### 1. Build Phase (GitHub Actions)

```
Source Files                Rust Build              Output
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€

JMdict_e.gz     â”€â”€â”
JMnedict.xml.gz â”€â”€â”¤
kanjidic2.xml.gzâ”€â”€â”¼â”€â”€â–¶  cargo run --release  â”€â”€â–¶  output_non_han/
cedict.txt.gz   â”€â”€â”¤     --bin merge_dicts        output_han_1char/
                  â”‚     --individual-files        output_han_2char/
                  â””â”€    --optimize                output_han_3plus/
                        --mode {shard}
```

### 2. Deployment Phase

```
Local Output              GitHub Push             jsDelivr CDN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

output_non_han/    â”€â”€â–¶   japanese-dict-non-han   â”€â”€â–¶  cdn.jsdelivr.net/gh/
  ã²ã‚‰ãŒãª.json                                         .../non-han@main/
  ã‚«ã‚¿ã‚«ãƒŠ.json                                         ã²ã‚‰ãŒãª.json

output_han_1char/  â”€â”€â–¶   japanese-dict-han-1char â”€â”€â–¶  cdn.jsdelivr.net/gh/
  å¥½.json                                              .../han-1char@main/
  åœ°.json                                              å¥½.json

output_han_2char/  â”€â”€â–¶   japanese-dict-han-2char â”€â”€â–¶  cdn.jsdelivr.net/gh/
  åœ°å›³.json                                            .../han-2char@main/
  å¥½ã.json                                            åœ°å›³.json

output_han_3plus/  â”€â”€â–¶   japanese-dict-han-3plus â”€â”€â–¶  cdn.jsdelivr.net/gh/
  ä¸€æŠŠå¥½æ‰‹.json                                        .../han-3plus@main/
  å›³æ›¸é¤¨.json                                          ä¸€æŠŠå¥½æ‰‹.json
```

### 3. Request Phase

```
User Request              Shard Detection         CDN Fetch
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€

/å¥½                 â”€â”€â–¶   countHanChars("å¥½")  â”€â”€â–¶  GET cdn.jsdelivr.net/
                          = 1                       gh/.../han-1char@main/
                          â†“                         å¥½.json
                          shard = "han-1char"       â†“
                                                    200 OK
                                                    { "k": "å¥½", ... }
```

## Sharding Logic

### Character Classification

```rust
fn is_han_character(c: char) -> bool {
    matches!(c,
        '\u{4E00}'..='\u{9FFF}'   | // CJK Unified Ideographs
        '\u{3400}'..='\u{4DBF}'   | // Extension A
        '\u{20000}'..='\u{2A6DF}' | // Extension B
        // ... more ranges
    )
}

fn get_shard(word: &str) -> ShardType {
    let han_count = word.chars()
        .filter(|c| is_han_character(*c))
        .count();
    
    match han_count {
        0 => ShardType::NonHan,      // ã²ã‚‰ãŒãª, ã‚«ã‚¿ã‚«ãƒŠ
        1 => ShardType::Han1Char,    // å¥½, åœ°, çš„
        2 => ShardType::Han2Char,    // åœ°å›³, å¥½ã
        _ => ShardType::Han3Plus,    // ä¸€æŠŠå¥½æ‰‹, å›³æ›¸é¤¨
    }
}
```

### Distribution Example

```
Input: "åœ°å›³ã‚’è¦‹ã‚‹"

Character Analysis:
â”œâ”€ åœ° â†’ Han (U+5730) âœ“
â”œâ”€ å›³ â†’ Han (U+56F3) âœ“
â”œâ”€ ã‚’ â†’ Hiragana âœ—
â”œâ”€ è¦‹ â†’ Han (U+898B) âœ“
â””â”€ ã‚‹ â†’ Hiragana âœ—

Han Count: 3
Shard: han-3plus
Output: output_han_3plus/åœ°å›³ã‚’è¦‹ã‚‹.json
```

## Performance Characteristics

### Build Performance

| Metric | Sequential | Matrix (Parallel) | Improvement |
|--------|-----------|-------------------|-------------|
| Build time | 60 min | 15 min | 4x faster |
| Upload time | 60 min | 15 min | 4x faster |
| **Total** | **120 min** | **30 min** | **4x faster** |

### Runtime Performance

| Operation | Time | Notes |
|-----------|------|-------|
| Shard detection | <1ms | Pure computation |
| jsDelivr fetch (cold) | 50-200ms | First request |
| jsDelivr fetch (warm) | 10-50ms | Cached |
| Page load | 100-300ms | Including all assets |

### Cost Analysis

| Resource | Usage | Cost |
|----------|-------|------|
| GitHub repos | 4 repos | FREE |
| GitHub storage | ~2.3 GB | FREE |
| GitHub Actions | 120 min/deploy | FREE (16 deploys/month) |
| jsDelivr CDN | Unlimited | FREE |
| **Total** | **All services** | **$0/month** âœ… |

## Scalability

### Horizontal Scaling

Add more shards if needed:

```yaml
# .github/workflows/build-dictionaries-matrix.yml
strategy:
  matrix:
    shard-type: 
      - non-han
      - han-1char
      - han-2char-common    # Split han-2char
      - han-2char-rare      # into common/rare
      - han-3plus
```

### Vertical Scaling

Optimize individual shards:

- Compress JSON files (gzip)
- Use binary format (MessagePack, Protocol Buffers)
- Implement pagination for large shards
- Add caching layer (Service Worker)

## Monitoring

### Health Checks

```bash
# Check if all shards are accessible
for shard in non-han han-1char han-2char han-3plus; do
  echo "Checking $shard..."
  curl -I "https://cdn.jsdelivr.net/gh/Kimeiga/japanese-dict-$shard@main/README.md"
done
```

### Metrics to Track

1. **Build metrics**
   - Build duration per shard
   - File count per shard
   - Total size per shard

2. **Deployment metrics**
   - Deployment success rate
   - Time to CDN propagation
   - Failed deployments

3. **Runtime metrics**
   - CDN hit rate
   - Average response time
   - Error rate (404s)

## Summary

**Architecture Benefits:**

âœ… **Free** - All services are free tier
âœ… **Fast** - 30 min deployments, <100ms page loads
âœ… **Scalable** - Easy to add more shards
âœ… **Reliable** - 99.9% uptime, 750+ CDN locations
âœ… **Simple** - Automatic shard detection
âœ… **Maintainable** - Clear separation of concerns

**Perfect for a dictionary with frequent updates!** ðŸš€

